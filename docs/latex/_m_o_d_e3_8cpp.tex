\hypertarget{_m_o_d_e3_8cpp}{}\doxysection{M\+O\+D\+E3.\+cpp File Reference}
\label{_m_o_d_e3_8cpp}\index{MODE3.cpp@{MODE3.cpp}}


Node to drive the robot assisting them to avoid collisions.  


{\ttfamily \#include \char`\"{}ros/ros.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}geometry\+\_\+msgs/\+Twist.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sensor\+\_\+msgs/\+Laser\+Scan.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$termios.\+h$>$}\newline
{\ttfamily \#include $<$map$>$}\newline
Include dependency graph for M\+O\+D\+E3.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_m_o_d_e3_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a0c412d48ccdce40e00c45eae6a90f28a}\label{_m_o_d_e3_8cpp_a0c412d48ccdce40e00c45eae6a90f28a}} 
float {\bfseries speed} (0.\+5)
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_addb83adac8170dcb113acaf93aeccf82}\label{_m_o_d_e3_8cpp_addb83adac8170dcb113acaf93aeccf82}} 
float {\bfseries turn} (1.\+0)
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a58456ccdd2b0d0e7ebb96c0a2ec7ec6f}\label{_m_o_d_e3_8cpp_a58456ccdd2b0d0e7ebb96c0a2ec7ec6f}} 
float {\bfseries x} (0)
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a2795aa30f97a85f1d013e24f6292a51e}\label{_m_o_d_e3_8cpp_a2795aa30f97a85f1d013e24f6292a51e}} 
float {\bfseries y} (0)
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_aec5d3cf4e6cb26ab7be21502b97087c9}\label{_m_o_d_e3_8cpp_aec5d3cf4e6cb26ab7be21502b97087c9}} 
float {\bfseries z} (0)
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_ad5ac4dec8b4343953b42a1e86edb874e}\label{_m_o_d_e3_8cpp_ad5ac4dec8b4343953b42a1e86edb874e}} 
float {\bfseries th} (0)
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a707311ac31b1d2e00c843eae201a6536}\label{_m_o_d_e3_8cpp_a707311ac31b1d2e00c843eae201a6536}} 
char \mbox{\hyperlink{_m_o_d_e3_8cpp_a707311ac31b1d2e00c843eae201a6536}{key}} (\textquotesingle{} \textquotesingle{})
\begin{DoxyCompactList}\small\item\em Character. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{_m_o_d_e3_8cpp_af5978fab9fa6dd4ced1c3a8ab1251f7b}{getch}} (void)
\item 
float \mbox{\hyperlink{_m_o_d_e3_8cpp_a00c3757057497a8569498b69523b4a1f}{Robot\+Distance}} (int min, int max, float dist\+\_\+obs\mbox{[}$\,$\mbox{]})
\item 
void \mbox{\hyperlink{_m_o_d_e3_8cpp_ae7695cae164b64ed66955d492df054ca}{Laser\+Callback}} (const sensor\+\_\+msgs\+::\+Laser\+Scan\+::\+Const\+Ptr \&scan)
\item 
void \mbox{\hyperlink{_m_o_d_e3_8cpp_afef03081108b5ffbbf11854a62083891}{Teleop}} ()
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}\label{_m_o_d_e3_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}} 
int {\bfseries main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a350594df3e8f6948c8462edfd41ce086}\label{_m_o_d_e3_8cpp_a350594df3e8f6948c8462edfd41ce086}} 
ros\+::\+Publisher {\bfseries pub}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a095e44054d29dc64e33a7fe9dab06503}\label{_m_o_d_e3_8cpp_a095e44054d29dc64e33a7fe9dab06503}} 
float {\bfseries minR}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a8ef99aef69ab3808aadc2663df8786f8}\label{_m_o_d_e3_8cpp_a8ef99aef69ab3808aadc2663df8786f8}} 
float {\bfseries min\+FR}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_ae096c148abbae129f2d24a0935d2e888}\label{_m_o_d_e3_8cpp_ae096c148abbae129f2d24a0935d2e888}} 
float {\bfseries minF}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a0eda685c394e5d3310d4826594892833}\label{_m_o_d_e3_8cpp_a0eda685c394e5d3310d4826594892833}} 
float {\bfseries min\+FL}
\item 
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a4a809d52e488da81f8b937ff2b5efa25}\label{_m_o_d_e3_8cpp_a4a809d52e488da81f8b937ff2b5efa25}} 
float \mbox{\hyperlink{_m_o_d_e3_8cpp_a4a809d52e488da81f8b937ff2b5efa25}{minL}}
\begin{DoxyCompactList}\small\item\em Minimum distance from an obstacle. \end{DoxyCompactList}\item 
std\+::map$<$ char, std\+::vector$<$ float $>$ $>$ \mbox{\hyperlink{_m_o_d_e3_8cpp_a91023ea7582580513b585f7b4c15f7d8}{move\+Bindings}}
\begin{DoxyCompactList}\small\item\em $<$ Matrix for movement \end{DoxyCompactList}\item 
std\+::map$<$ char, std\+::vector$<$ float $>$ $>$ \mbox{\hyperlink{_m_o_d_e3_8cpp_a942d4f1c3e151d6f264d0868766b08b0}{speed\+Bindings}}
\begin{DoxyCompactList}\small\item\em $<$ Matrix for speed \end{DoxyCompactList}\item 
const char $\ast$ {\bfseries msg}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Node to drive the robot assisting them to avoid collisions. 

\begin{DoxyAuthor}{Author}
Alice Rivi
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1
\end{DoxyVersion}
\begin{DoxyDate}{Date}
18/03/2022
\end{DoxyDate}
Publishes\+: ~\newline
 °/cmd\+\_\+vel

Subscribes \+:~\newline
 °/scan

Description\+: Through this code the user can guide the robot through the environment using the keyboard and is helped to avoid collisions with obstacles. Iin order to be able to move the robot via the keyboard, it may be useful to exploit the keyboard teleop program. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{_m_o_d_e3_8cpp_af5978fab9fa6dd4ced1c3a8ab1251f7b}\label{_m_o_d_e3_8cpp_af5978fab9fa6dd4ced1c3a8ab1251f7b}} 
\index{MODE3.cpp@{MODE3.cpp}!getch@{getch}}
\index{getch@{getch}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{getch()}{getch()}}
{\footnotesize\ttfamily int getch (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Function to avoid input blocking

return the character choosen by the keyboard

This function manages user-\/generated keyboard inputs by preventing them from blocking\mbox{\Hypertarget{_m_o_d_e3_8cpp_ae7695cae164b64ed66955d492df054ca}\label{_m_o_d_e3_8cpp_ae7695cae164b64ed66955d492df054ca}} 
\index{MODE3.cpp@{MODE3.cpp}!LaserCallback@{LaserCallback}}
\index{LaserCallback@{LaserCallback}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{LaserCallback()}{LaserCallback()}}
{\footnotesize\ttfamily void Laser\+Callback (\begin{DoxyParamCaption}\item[{const sensor\+\_\+msgs\+::\+Laser\+Scan\+::\+Const\+Ptr \&}]{scan }\end{DoxyParamCaption})}

Function hande the datas about /scan topic


\begin{DoxyParams}{Parameters}
{\em scan} & defines the message type of Laser\+Scan\\
\hline
\end{DoxyParams}
This function is called when a message is posted on the /scan topic. With this function the velocity is published on the /cmd\+\_\+vel topic and with the control algorithm it possible to determine the evolution of the robot based on the distance.\mbox{\Hypertarget{_m_o_d_e3_8cpp_a00c3757057497a8569498b69523b4a1f}\label{_m_o_d_e3_8cpp_a00c3757057497a8569498b69523b4a1f}} 
\index{MODE3.cpp@{MODE3.cpp}!RobotDistance@{RobotDistance}}
\index{RobotDistance@{RobotDistance}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{RobotDistance()}{RobotDistance()}}
{\footnotesize\ttfamily float Robot\+Distance (\begin{DoxyParamCaption}\item[{int}]{min,  }\item[{int}]{max,  }\item[{float}]{dist\+\_\+obs\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

Function to calculate the minimum distance rom an obstacle in a range of 720 elements


\begin{DoxyParams}{Parameters}
{\em min} & defines minimum value acceptable \\
\hline
{\em max} & defines maximum value acceptbale \\
\hline
{\em dist\+\_\+obs\mbox{[}$\,$\mbox{]}} & defines the range of the value calculated\\
\hline
\end{DoxyParams}
return the minimum distance

This function calculates the minimum distance from an obstacle in a range of 720 elements\mbox{\Hypertarget{_m_o_d_e3_8cpp_afef03081108b5ffbbf11854a62083891}\label{_m_o_d_e3_8cpp_afef03081108b5ffbbf11854a62083891}} 
\index{MODE3.cpp@{MODE3.cpp}!Teleop@{Teleop}}
\index{Teleop@{Teleop}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{Teleop()}{Teleop()}}
{\footnotesize\ttfamily void Teleop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Function to control the robot

This function allows the robot to move according to commands given by the user

\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a91023ea7582580513b585f7b4c15f7d8}\label{_m_o_d_e3_8cpp_a91023ea7582580513b585f7b4c15f7d8}} 
\index{MODE3.cpp@{MODE3.cpp}!moveBindings@{moveBindings}}
\index{moveBindings@{moveBindings}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{moveBindings}{moveBindings}}
{\footnotesize\ttfamily std\+::map$<$char, std\+::vector$<$float$>$ $>$ move\+Bindings}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{  \{\textcolor{charliteral}{'i'}, \{1, 0, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'o'}, \{1, 0, 0, -\/1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'j'}, \{0, 0, 0, 1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'l'}, \{0, 0, 0, -\/1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'u'}, \{1, 0, 0, 1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{','}, \{-\/1, 0, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'.'}, \{-\/1, 0, 0, 1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'m'}, \{-\/1, 0, 0, -\/1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'O'}, \{1, -\/1, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'I'}, \{1, 0, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'J'}, \{0, 1, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'L'}, \{0, -\/1, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'U'}, \{1, 1, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'<'}, \{-\/1, 0, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'>'}, \{-\/1, -\/1, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'M'}, \{-\/1, 1, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'t'}, \{0, 0, 1, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'b'}, \{0, 0, -\/1, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'k'}, \{0, 0, 0, 0\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'K'}, \{0, 0, 0, 0\}\}}
\DoxyCodeLine{\}}

\end{DoxyCode}


$<$ Matrix for movement 

\mbox{\Hypertarget{_m_o_d_e3_8cpp_a2c3cb87d009c003069b9a90f020f8a9f}\label{_m_o_d_e3_8cpp_a2c3cb87d009c003069b9a90f020f8a9f}} 
\index{MODE3.cpp@{MODE3.cpp}!msg@{msg}}
\index{msg@{msg}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{msg}{msg}}
{\footnotesize\ttfamily const char$\ast$ msg}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= R\textcolor{stringliteral}{"(}}
\DoxyCodeLine{\textcolor{stringliteral}{  Reading from the keyboard and Publishing to Twist!}}
\DoxyCodeLine{\textcolor{stringliteral}{  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\textcolor{stringliteral}{  Moving around:}}
\DoxyCodeLine{\textcolor{stringliteral}{     u    i    orom an obstacle in a range of 720 elements}}
\DoxyCodeLine{\textcolor{stringliteral}{     j    k    l}}
\DoxyCodeLine{\textcolor{stringliteral}{     m    ,    .}}
\DoxyCodeLine{\textcolor{stringliteral}{}}
\DoxyCodeLine{\textcolor{stringliteral}{  For Holonomic mode (strafing), hold down the shift key:}}
\DoxyCodeLine{\textcolor{stringliteral}{  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\textcolor{stringliteral}{     U    I    O}}
\DoxyCodeLine{\textcolor{stringliteral}{     J    K    L}}
\DoxyCodeLine{\textcolor{stringliteral}{     M    <    >}}
\DoxyCodeLine{\textcolor{stringliteral}{}}
\DoxyCodeLine{\textcolor{stringliteral}{  t : up (+z)}}
\DoxyCodeLine{\textcolor{stringliteral}{  b : down (-\/z)}}
\DoxyCodeLine{\textcolor{stringliteral}{}}
\DoxyCodeLine{\textcolor{stringliteral}{  anything else : stop}}
\DoxyCodeLine{\textcolor{stringliteral}{}}
\DoxyCodeLine{\textcolor{stringliteral}{  q/z : increase/decrease max speeds by 10\%}}
\DoxyCodeLine{\textcolor{stringliteral}{  w/x : increase/decrease only linear speed by 10\%}}
\DoxyCodeLine{\textcolor{stringliteral}{  e/c : increase/decrease only angular speed by 10\%}}
\DoxyCodeLine{\textcolor{stringliteral}{}}
\DoxyCodeLine{\textcolor{stringliteral}{  CTRL-\/C to return to the user interface}}
\DoxyCodeLine{\textcolor{stringliteral}{  )"}}

\end{DoxyCode}
\mbox{\Hypertarget{_m_o_d_e3_8cpp_a942d4f1c3e151d6f264d0868766b08b0}\label{_m_o_d_e3_8cpp_a942d4f1c3e151d6f264d0868766b08b0}} 
\index{MODE3.cpp@{MODE3.cpp}!speedBindings@{speedBindings}}
\index{speedBindings@{speedBindings}!MODE3.cpp@{MODE3.cpp}}
\doxysubsubsection{\texorpdfstring{speedBindings}{speedBindings}}
{\footnotesize\ttfamily std\+::map$<$char, std\+::vector$<$float$>$ $>$ speed\+Bindings}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{  \{\textcolor{charliteral}{'q'}, \{1.1, 1.1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'z'}, \{0.9, 0.9\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'w'}, \{1.1, 1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'x'}, \{0.9, 1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'e'}, \{1, 1.1\}\},}
\DoxyCodeLine{  \{\textcolor{charliteral}{'c'}, \{1, 0.9\}\}}
\DoxyCodeLine{\}}

\end{DoxyCode}


$<$ Matrix for speed 

